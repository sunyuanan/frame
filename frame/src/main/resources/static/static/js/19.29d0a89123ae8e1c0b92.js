webpackJsonp([19],{"5abd":function(e,t){},sA44:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),n=r.n(a),s=r("exGp"),o=r.n(s),i=r("7RZP"),u=r("QbhR"),c={name:"Job",data:function(){return{tableData:[],tabH:0,page:{total:0,limit:0,page:u.d.currentPage},dialog:!1,title:"",form:{status:"0"},rules:{remark:[{required:!0,message:"请输入描述",trigger:"blur"}],jobName:[{required:!0,message:"请输入执行类",trigger:"blur"}],jobGroup:[{required:!0,message:"请输入任务分组",trigger:"blur"}],methodName:[{required:!0,message:"请输入执行方法",trigger:"blur"}],cronExpression:[{required:!0,message:"请输入执行表达式",trigger:"blur"}]},jobId:null}},created:function(){var e=Object(u.a)();this.tabH=e.tabH,this.page.limit=e.tabNum},mounted:function(){this.jobListByPage()},methods:{showEditJobDialog:function(e){this.jobId=e.id,this.form=e,this.dialog=!0,this.title="编辑任务调度"},clearFormData:function(){this.$refs.form.resetFields(),this.form={status:"0"},this.dialog=!1,this.jobListByPage()},submitForm:function(e){var t=this,r=this.jobId,a=this.form.jobName,n=this.form.jobGroup,s=this.form.methodName,o=this.form.cronExpression,i=this.form.status,u=this.form.remark;this.$refs[e].validate(function(e){if(!e)return!1;null==r?t.addJobInfo(a,n,s,o,i,u):t.editJobInfo(r,a,n,s,o,i,u)})},addJobInfo:function(e,t,r,a,s,u){var c=this;return o()(n.a.mark(function o(){var l,m;return n.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(i.f)(e,t,r,a,s,u);case 2:if(l=n.sent,0!==(m=l.data).code){n.next=9;break}return c.clearFormData(),n.abrupt("return",c.$message.success(m.msg));case 9:return n.abrupt("return",c.$message.error(m.msg));case 10:case"end":return n.stop()}},o,c)}))()},editJobInfo:function(e,t,r,a,s,u,c){var l=this;return o()(n.a.mark(function o(){var m,f;return n.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(i.E)(e,t,r,a,s,u,c);case 2:if(m=n.sent,0!==(f=m.data).code){n.next=9;break}return l.clearFormData(),n.abrupt("return",l.$message.success(f.msg));case 9:return n.abrupt("return",l.$message.error(f.msg));case 10:case"end":return n.stop()}},o,l)}))()},showDialog:function(){this.title="新增任务调度",this.dialog=!0},jobListByPage:function(){var e=this;return o()(n.a.mark(function t(){var r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(i.M)(e.page.page,e.page.limitsearch).then(function(t){var r=t.data;return 0===r.code?r.data:(console.log(r),e.$message.error(r.msg))});case 2:r=t.sent,e.tableData=r.records,e.page.total=r.total;case 5:case"end":return t.stop()}},t,e)}))()},pageFun:function(e){var t=this;return o()(n.a.mark(function r(){var a;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(i.M)(e,t.page.limit).then(function(e){var r=e.data;return 0===r.code?r.data:t.$message.error(r.msg)});case 2:a=r.sent,t.tableData=a.records,t.page.total=a.total;case 5:case"end":return r.stop()}},r,t)}))()},triggerTask:function(e){var t=this;return o()(n.a.mark(function r(){var a;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return(a=[]).push(e),r.next=4,Object(i._5)(a).then(function(e){var r=e.data;return 0===r.code?r.data:t.$message.error(r.msg)});case 4:r.sent,t.$message.success("执行成功"),t.jobListByPage();case 7:case"end":return r.stop()}},r,t)}))()},pauseTask:function(e){var t=this;return o()(n.a.mark(function r(){var a;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return(a=[]).push(e),r.next=4,Object(i.U)(a).then(function(e){var r=e.data;return 0===r.code?r.data:t.$message.error(r.msg)});case 4:r.sent,t.$message.success("已停止任务"),t.jobListByPage();case 7:case"end":return r.stop()}},r,t)}))()},resumeTask:function(e){var t=this;return o()(n.a.mark(function r(){var a;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return(a=[]).push(e),r.next=4,Object(i.Y)(a).then(function(e){var r=e.data;return 0===r.code?r.data:t.$message.error(r.msg)});case 4:r.sent,t.$message.success("已恢复任务"),t.jobListByPage();case 7:case"end":return r.stop()}},r,t)}))()},deleteTask:function(e){var t=this;return o()(n.a.mark(function r(){var a;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return(a=[]).push(e),r.next=4,Object(i.v)(a).then(function(e){var r=e.data;return 0===r.code?r.data:t.$message.error(r.msg)});case 4:r.sent,t.$message.success("删除成功"),t.jobListByPage();case 7:case"end":return r.stop()}},r,t)}))()}}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main_container"},[r("div",{staticClass:"tab_container"},[r("div",{staticClass:"operation"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showDialog()}}},[e._v("添加任务")])],1),e._v(" "),r("el-table",{attrs:{data:e.tableData,height:e.tabH}},[r("el-table-column",{attrs:{label:"描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.remark))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"任务名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.jobName))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"任务分组"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.jobGroup))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"执行方法"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.methodName))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"方法参数"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.methodParams))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"执行表达式"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.cronExpression))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(e){return[r("span",[r("el-switch",{attrs:{value:0==e.row.status,"active-color":"#13ce66","inactive-color":"#ff4949",disabled:""}})],1)]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"360"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(r){return e.showEditJobDialog(t.row)}}},[e._v("编辑")]),e._v(" "),r("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(r){return e.triggerTask(t.row.id)}}},[e._v("执行")]),e._v(" "),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.pauseTask(t.row.id)}}},[e._v("停止")]),e._v(" "),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.resumeTask(t.row.id)}}},[e._v("恢复")]),e._v(" "),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){return e.deleteTask(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),r("div",{staticClass:"page"},[r("el-pagination",{attrs:{background:"","current-page":e.page.page,"page-size":e.page.limit,layout:"total, prev, pager, next, jumper",total:e.page.total},on:{"current-change":e.pageFun,"update:currentPage":function(t){return e.$set(e.page,"page",t)},"update:current-page":function(t){return e.$set(e.page,"page",t)}}})],1)],1),e._v(" "),r("div",{staticClass:"dialog_container"},[r("el-dialog",{attrs:{title:e.title,visible:e.dialog,width:"50%",center:""},on:{"update:visible":function(t){e.dialog=t},close:function(t){return e.clearFormData()}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,inline:!0,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"描述",prop:"remark"}},[r("el-input",{attrs:{placeholder:"请输入描述"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"执行类",prop:"jobName"}},[r("el-input",{attrs:{placeholder:"请输入执行类"},model:{value:e.form.jobName,callback:function(t){e.$set(e.form,"jobName",t)},expression:"form.jobName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"任务分组",prop:"jobGroup"}},[r("el-input",{attrs:{placeholder:"请输入任务分组"},model:{value:e.form.jobGroup,callback:function(t){e.$set(e.form,"jobGroup",t)},expression:"form.jobGroup"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"执行方法",prop:"methodName"}},[r("el-input",{attrs:{placeholder:"请输入执行方法"},model:{value:e.form.methodName,callback:function(t){e.$set(e.form,"methodName",t)},expression:"form.methodName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"执行参数"}},[r("el-input",{attrs:{placeholder:"请输入执行参数"},model:{value:e.form.methodParams,callback:function(t){e.$set(e.form,"methodParams",t)},expression:"form.methodParams"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"执行表达式",prop:"cronExpression"}},[r("el-input",{attrs:{placeholder:"请输入执行表达式"},model:{value:e.form.cronExpression,callback:function(t){e.$set(e.form,"cronExpression",t)},expression:"form.cronExpression"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"状态",prop:"status"}},[r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"0","inactive-value":"1"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog_button"},[r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("确 定")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.clearFormData()}}},[e._v("取 消")])],1)],1)],1)])},staticRenderFns:[]};var m=r("VU/8")(c,l,!1,function(e){r("5abd")},"data-v-019e84f4",null);t.default=m.exports}});
//# sourceMappingURL=19.29d0a89123ae8e1c0b92.js.map