webpackJsonp([8],{clGQ:function(e,t){},"v5/8":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("Xxa5"),n=s.n(r),a=s("exGp"),i=s.n(a),o=s("7RZP"),c=s("QbhR"),l={name:"SysRole",data:function(){return{tableData:[],tabH:0,page:{total:0,limit:0,page:c.d.currentPage},form:{status:"1"},dialog:!1,rules:{name:[{required:!0,message:"请输入角色名",trigger:"blur"}]},title:"",name:"",id:null,menusList:[],permissionList:[],menusList1:[],permissionList1:[],defaultProps:{children:"children",label:"name"},menusEdList:[],permissionEdList:[],menusAllList:[],permissionAllList:[],checkEdList:[],menusVal:"2",permissionVal:"2"}},created:function(){var e=Object(c.a)();this.tabH=e.tabH,this.page.limit=e.tabNum},mounted:function(){this.listByPage(),this.showMenusListByTree(),this.showPermissionListByTree(),this.showPermissionAndMenusAllList()},methods:{menusSelectAll:function(e){if(2==e)this.$refs.menusTree.setCheckedKeys([]);else{for(var t=[],s=0;s<this.menusAllList.length;s++)t.push(this.menusAllList[s].id);this.$refs.menusTree.setCheckedKeys(t)}},permissionSelectAll:function(e){if(2==e)this.$refs.permissionTree.setCheckedKeys([]);else{for(var t=[],s=0;s<this.permissionAllList.length;s++)t.push(this.permissionAllList[s].id);this.$refs.permissionTree.setCheckedKeys(t)}},getRoleInfo:function(e){this.showPermissionAndMenusList(e)},submitForm:function(e){for(var t=this,s=this.id,r=[],n=this.$refs.menusTree.getCheckedNodes(!1,!0),a=0;a<n.length;a++)r.push(n[a].id);console.log(r);var i=this.$refs.permissionTree.getCheckedKeys(!0),o=this.form.name,c=this.form.description,l=this.form.status;this.$refs[e].validate(function(e){if(!e)return!1;null==s?t.addRoleInfo(o,c,l,r,i):t.editRoleInfo(s,o,c,l,r,i)})},addRoleInfo:function(e,t,s,r,a){var c=this;return i()(n.a.mark(function i(){var l,u,m;return n.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return l=r.concat(a),n.next=3,Object(o.h)(e,t,s,l);case 3:if(u=n.sent,0!==(m=u.data).code){n.next=10;break}return c.clearFormData(),n.abrupt("return",c.$message.success(m.msg));case 10:return n.abrupt("return",c.$message.error(m.msg));case 11:case"end":return n.stop()}},i,c)}))()},editRoleInfo:function(e,t,s,r,a,c){var l=this;return i()(n.a.mark(function i(){var u,m,d;return n.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return u=a.concat(c),n.next=3,Object(o.F)(e,t,s,r,u);case 3:if(m=n.sent,0!==(d=m.data).code){n.next=10;break}return l.clearFormData(),n.abrupt("return",l.$message.success(d.msg));case 10:return n.abrupt("return",l.$message.error(d.msg));case 11:case"end":return n.stop()}},i,l)}))()},showDiglog:function(){this.title="添加角色",this.dialog=!0},clearFormData:function(){this.$refs.form.resetFields(),this.form={status:"1"},this.id=null,this.menusEdList=[],this.permissionEdList=[],this.menusVal="2",this.permissionVal="2",this.dialog=!1,this.listByPage()},listByPage:function(){var e=this;return i()(n.a.mark(function t(){var s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.N)(e.page.page,e.page.limit,e.name).then(function(t){var s=t.data;return 0===s.code?s.data:e.$message.error(s.msg)});case 2:s=t.sent,e.tableData=s.records,e.page.total=s.total;case 5:case"end":return t.stop()}},t,e)}))()},pageFun:function(e){var t=this;return i()(n.a.mark(function s(){var r;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(o.N)(e,t.page.limit,t.name).then(function(e){var s=e.data;return 0===s.code?s.data:t.$message.error(s.msg)});case 2:r=s.sent,t.tableData=r.records,t.page.total=r.total;case 5:case"end":return s.stop()}},s,t)}))()},searchTableData:function(){this.listByPage()},deleteRoleInfo:function(e){var t=this;return i()(n.a.mark(function s(){var r;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return(r=[]).push(e),s.next=4,Object(o.t)(r).then(function(e){var s=e.data;return 0===s.code?(t.listByPage(),t.$message.success("删除成功")):t.$message.error(s.msg)});case 4:case"end":return s.stop()}},s,t)}))()},showMenusListByTree:function(){var e=this;return i()(n.a.mark(function t(){var s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.T)().then(function(t){var s=t.data;return 0===s.code?s.data:e.$message.error(s.msg)});case 2:s=t.sent,e.menusList=s;case 4:case"end":return t.stop()}},t,e)}))()},showPermissionListByTree:function(){var e=this;return i()(n.a.mark(function t(){var s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.W)().then(function(t){var s=t.data;return 0===s.code?s.data:e.$message.error(s.msg)});case 2:s=t.sent,e.permissionList=s;case 4:case"end":return t.stop()}},t,e)}))()},showPermissionAndMenusList:function(e){var t=this;return i()(n.a.mark(function s(){var r;return n.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(o.V)(e.id).then(function(e){var s=e.data;return 0===s.code?s.data:t.$message.error(s.msg)});case 2:r=s.sent,t.menusEdList=r.menusList,t.permissionEdList=r.permissionList,t.form=e,t.id=e.id,t.title="编辑角色",t.dialog=!0;case 9:case"end":return s.stop()}},s,t)}))()},showPermissionAndMenusAllList:function(){var e=this;return i()(n.a.mark(function t(){return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.permissionListData(),e.permissionList1Data();case 2:case"end":return t.stop()}},t,e)}))()},permissionListData:function(){var e=this;return i()(n.a.mark(function t(){var s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.J)(1).then(function(t){var s=t.data;return 0===s.code?s.data:e.$message.error(s.msg)});case 2:s=t.sent,e.menusAllList=s;case 4:case"end":return t.stop()}},t,e)}))()},permissionList1Data:function(){var e=this;return i()(n.a.mark(function t(){var s;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.J)(3).then(function(t){var s=t.data;return 0===s.code?s.data:e.$message.error(s.msg)});case 2:s=t.sent,e.permissionAllList=s;case 4:case"end":return t.stop()}},t,e)}))()}}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"main_container"},[s("div",{staticClass:"tab_container"},[s("div",{staticClass:"operation"},[s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(t){return e.showDiglog()}}},[e._v("添加角色")]),e._v(" "),s("el-input",{staticClass:"search_input",attrs:{placeholder:"输入角色名","suffix-icon":"el-icon-search"},on:{input:function(t){return e.searchTableData()}},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),s("el-table",{attrs:{data:e.tableData,height:e.tabH}},[s("el-table-column",{attrs:{label:"角色名"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.name))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.createTime))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"更新时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",[e._v(e._s(t.row.updateTime))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(e){return[s("el-switch",{attrs:{value:e.row.status,"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.getRoleInfo(t.row)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(s){return e.deleteRoleInfo(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("div",{staticClass:"page"},[s("el-pagination",{attrs:{background:"","current-page":e.page.page,"page-size":e.page.limit,layout:"total, prev, pager, next, jumper",total:e.page.total},on:{"current-change":e.pageFun,"update:currentPage":function(t){return e.$set(e.page,"page",t)},"update:current-page":function(t){return e.$set(e.page,"page",t)}}})],1)],1),e._v(" "),s("div",{staticClass:"dialog_container"},[s("el-dialog",{attrs:{title:e.title,visible:e.dialog,width:"80%",center:"",top:"3vh","destroy-on-close":!0},on:{"update:visible":function(t){e.dialog=t},close:function(t){return e.clearFormData()}}},[s("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,inline:!0,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"角色名",prop:"name"}},[s("el-input",{attrs:{placeholder:"请输入角色名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"描述",prop:"description"}},[s("el-input",{attrs:{placeholder:"请输入描述"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"状态",prop:"status"}},[s("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949","active-value":"1","inactive-value":"0"},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:30}},[s("el-col",{attrs:{span:12}},[s("h3",[e._v("配置菜单 "),s("el-checkbox",{attrs:{"true-label":"1","false-label":"2"},on:{change:e.menusSelectAll},model:{value:e.menusVal,callback:function(t){e.menusVal=t},expression:"menusVal"}},[e._v("全选\n            ")])],1),e._v(" "),s("div",{staticStyle:{height:"600px",overflow:"hidden","overflow-y":"auto"}},[s("el-tree",{ref:"menusTree",staticStyle:{"margin-top":"10px"},attrs:{data:e.menusList,"show-checkbox":"","node-key":"id",props:e.defaultProps,"default-expand-all":!0,"default-checked-keys":e.menusEdList}})],1)]),e._v(" "),s("el-col",{attrs:{span:12}},[s("h3",[e._v("配置接口权限\n            "),s("el-checkbox",{attrs:{"true-label":"1","false-label":"2"},on:{change:e.permissionSelectAll},model:{value:e.permissionVal,callback:function(t){e.permissionVal=t},expression:"permissionVal"}},[e._v("全选\n            ")])],1),e._v(" "),s("div",{staticStyle:{height:"600px",overflow:"hidden","overflow-y":"auto"}},[s("el-tree",{ref:"permissionTree",staticStyle:{"margin-top":"10px"},attrs:{data:e.permissionList,"show-checkbox":"","node-key":"id",props:e.defaultProps,"default-expand-all":!0,"default-checked-keys":e.permissionEdList}})],1)])],1),e._v(" "),s("div",{staticClass:"dialog_button"},[s("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("确 定")]),e._v(" "),s("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.clearFormData()}}},[e._v("取 消")])],1)],1)],1)])},staticRenderFns:[]};var m=s("VU/8")(l,u,!1,function(e){s("clGQ")},"data-v-6063bb6e",null);t.default=m.exports}});
//# sourceMappingURL=8.85793e7a29dd3a353763.js.map