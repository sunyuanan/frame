webpackJsonp([17],{"70bZ":function(e,t){},cWvr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),n=a.n(r),s=a("exGp"),i=a.n(s),l=a("Lkus"),o=a("7RZP"),u=a("QbhR"),c={name:"File",data:function(){return{search:"",tableData:[],tabH:0,page:{total:0,limit:0,page:u.d.currentPage},dialog:!1,title:"",form:{},options:[],value:"",rules:{pid:[{required:!0,message:"请选择所属菜单",trigger:"blur"}],name:[{required:!0,message:"请输入菜单名称",trigger:"blur"}],orderNum:[{required:!0,message:"请输入排序",trigger:"blur"}]},fjdlList:[],fjlxList:[],fileList:[],templateParams:{},uploadAddress:l.a+"/file/upload?authorization="+sessionStorage.getItem("token"),id:null}},created:function(){var e=Object(u.a)();this.tabH=e.tabH,this.page.limit=e.tabNum},mounted:function(){this.listByPage(),this.getDictFjdl(),this.getDictFjlx()},methods:{deleteFileInfo:function(e){var t=this;return i()(n.a.mark(function a(){var r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return(r=[]).push(e),a.next=4,Object(o.p)(r).then(function(e){var a=e.data;return 0===a.code?(t.listByPage(),t.$message.success("删除成功")):t.$message.error(a.msg)});case 4:case"end":return a.stop()}},a,t)}))()},showEditFileDialog:function(e){this.form=e,this.id=e.id,this.title="编辑附件",this.dialog=!0},submitForm:function(e){var t=this,a=this.id,r=this.form.fjdl,n=this.form.fjlx,s=this.templateParams.filePath,i=this.templateParams.realName;this.$refs[e].validate(function(e){if(!e)return!1;null==a?t.addFile(r,n,s,i):t.editFile(a,r,n,s,i)})},editFile:function(e,t,a,r,s){var l=this;return i()(n.a.mark(function i(){var u,c;return n.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(o.B)(e,t,a,r,s);case 2:if(u=n.sent,0!==(c=u.data).code){n.next=9;break}return l.clearFormData(),n.abrupt("return",l.$message.success(c.msg));case 9:return n.abrupt("return",l.$message.error(c.msg));case 10:case"end":return n.stop()}},i,l)}))()},addFile:function(e,t,a,r){var s=this;return i()(n.a.mark(function i(){var l,u;return n.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(o.a)(e,t,a,r);case 2:if(l=n.sent,0!==(u=l.data).code){n.next=9;break}return s.clearFormData(),n.abrupt("return",s.$message.success(u.msg));case 9:return n.abrupt("return",s.$message.error(u.msg));case 10:case"end":return n.stop()}},i,s)}))()},clearFormData:function(){this.$refs.form.resetFields(),this.form={},this.fileList=[],this.id=null,this.dialog=!1,this.listByPage()},getDictFjdl:function(){var e=this;return i()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.I)("majorCategories").then(function(t){var a=t.data;return 0===a.code?a.data:e.$message.error(a.msg)});case 2:a=t.sent,e.fjdlList=a;case 4:case"end":return t.stop()}},t,e)}))()},getDictFjlx:function(){var e=this;return i()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.I)("systemPathConfiguration").then(function(t){var a=t.data;return 0===a.code?a.data:e.$message.error(a.msg)});case 2:a=t.sent,e.fjlxList=a;case 4:case"end":return t.stop()}},t,e)}))()},listByPage:function(){var e=this;return i()(n.a.mark(function t(){var a;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(o.X)(e.page.page,e.page.limit,e.search).then(function(t){var a=t.data;return 0===a.code?a.data:e.$message.error(a.msg)});case 2:a=t.sent,e.tableData=a.records,e.page.total=a.total;case 5:case"end":return t.stop()}},t,e)}))()},pageFun:function(e){var t=this;return i()(n.a.mark(function a(){var r;return n.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(o.X)(e,t.page.limit,t.search).then(function(e){var a=e.data;return 0===a.code?a.data:t.$message.error(a.msg)});case 2:r=a.sent,t.tableData=r.records,t.page.total=r.total;case 5:case"end":return a.stop()}},a,t)}))()},showFileDiglog:function(){this.title="添加附件",this.dialog=!0},handleAvatarSuccess:function(e,t){console.log(e),console.log(t),0===e.code&&(this.templateParams.filePath=e.data.filePath+e.data.fileName,this.templateParams.realName=e.data.realName);var a={name:e.data.realName};this.fileList=[],this.fileList.push(a)},beforeRemove:function(e,t){this.fileList=[],this.templateParams.filePath=null}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main_container"},[a("div",{staticClass:"tab_container"},[a("div",{staticClass:"operation"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.showFileDiglog()}}},[e._v("添加附件")]),e._v(" "),a("el-input",{staticClass:"search_input",attrs:{placeholder:"附件大类/附件类型/原始名称/后缀名","suffix-icon":"el-icon-search"},on:{input:function(t){return e.listByPage()}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,height:e.tabH,"default-expand-all":"","row-key":"id"}},[a("el-table-column",{attrs:{label:"原始名称","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.ysmc))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"附件大类"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fjdl))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"附件类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fjlx))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"后缀名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.fjhzm))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.createTime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.showEditFileDialog(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.deleteFileInfo(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("div",{staticClass:"page"},[a("el-pagination",{attrs:{background:"","current-page":e.page.page,"page-size":e.page.limit,layout:"total, prev, pager, next, jumper",total:e.page.total},on:{"current-change":e.pageFun,"update:currentPage":function(t){return e.$set(e.page,"page",t)},"update:current-page":function(t){return e.$set(e.page,"page",t)}}})],1)],1),e._v(" "),a("div",{staticClass:"dialog_container"},[a("el-dialog",{attrs:{title:e.title,visible:e.dialog,width:"30%",center:""},on:{"update:visible":function(t){e.dialog=t},close:function(t){return e.clearFormData()}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,inline:!0,"label-width":"140px"}},[a("el-form-item",{attrs:{label:"附件大类",prop:"fjdl"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.fjdl,callback:function(t){e.$set(e.form,"fjdl",t)},expression:"form.fjdl"}},e._l(e.fjdlList,function(e){return a("el-option",{key:e.id,attrs:{label:e.dictLabel,value:e.dictLabel}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"附件类型",prop:"fjlx"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:e.form.fjlx,callback:function(t){e.$set(e.form,"fjlx",t)},expression:"form.fjlx"}},e._l(e.fjlxList,function(e){return a("el-option",{key:e.id,attrs:{label:e.dictLabel,value:e.dictLabel}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"附件上传"}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:e.uploadAddress,multiple:"",limit:1,"on-success":e.handleAvatarSuccess,"file-list":e.fileList,"before-remove":e.beforeRemove}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog_button"},[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.submitForm("form")}}},[e._v("确 定")]),e._v(" "),a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:function(t){return e.clearFormData()}}},[e._v("取 消")])],1)],1)],1)])},staticRenderFns:[]};var d=a("VU/8")(c,f,!1,function(e){a("70bZ")},"data-v-27a2daa9",null);t.default=d.exports}});
//# sourceMappingURL=17.333a91fc31b1420a1d0a.js.map